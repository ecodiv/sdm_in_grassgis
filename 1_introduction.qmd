# Introduction {#sec-introduction}

This tutorial introduces a GRASS tool set for species distribution modeling, and shows how to use it effectively in combination with other core modules and add-ons to predict the future potential distribution of the almond-eyed ringlet butterfly. It also includes a few examples illustrating how the GRASS environment facilitates the exploration and interpretation of model results within their geographic context.

The first part focuses on the essential building blocks of creating a species distribution model, from data collection to prediction. In the second part, we’ll dive deeper into the options, choices, and parameter settings to validate and fine-tune the model.

![Potential habitat of the Almond-eyed Ringlet (*Erebia alberganus*) in the Alps. Source: Paulo van Breugel](images/habitat.jpg){#fig-habitatalps fig-align="left"}

This tutorial assumes basic knowledge of species distribution modeling (SDM) and GRASS. Are you new to SDM? Start with this free [video course by BCCVL](https://www.youtube.com/playlist?list=PL8nSYhbf9nDSotrn-JSZiJki1sTnnw3yS) or read Elith et al. [-@elith2009] for a deeper dive. New to GRASS? First read [Get started with GRASS GUI](https://grass-tutorials.osgeo.org/content/tutorials/get_started/fast_track.html) for a quick introduction and [Appendix A](A1_grassbasics.qmd) for some additional notes on working with GRASS.

## Using the reader

This reader guides you step by step through the species modeling process. The examples demonstrate how to execute functions via the command line [{{< fa solid terminal >}}]{.paneltabcolor}, Python scripts [{{< fa brands python >}}]{.paneltabcolor}, and the GUI dialogs [{{< fa regular window-restore >}}]{.paneltabcolor}. If there is a [{{< fa question >}}]{.paneltabcolor} tab, click it for tips or code explanations.

::: {.callout-warning  appearance="simple"}

Do not copy command-line examples blindly. Code snippets often contain placeholders, such as `path-to-file`, that must be replaced with, in this case, the actual location of the file on your system. Always check whether paths, filenames, and parameters need to be adapted before running a command.

:::

While detailed explanations of the various settings and parameters are not always provided, each function includes a link to its corresponding help page. These help pages are comprehensive, and reading them is highly recommended to fully understand the choices made in the tutorial and the options available to you.

::: {.callout-tip appearance="simple" collapse="true"}
## Typographical conventions

This tutorial uses consistent typographic conventions to distinguish between data objects, software elements, and code-related concepts. Paying attention to these conventions will help you understand what you are expected to click, type, or interpret at each step.

| Element | Example |
|-------|--------|
| Databases, folders, files | [SDM]{.style-data}, [maxent.jar]{.style-data} |
| GRASS data layers | [bio_1@climate]{.style-data} |
| Programs and libraries | *GRASS GIS*, *QGIS* |
| GRASS modules, functions | `r.maxent`, `v.import()` |
| Parameters, variables | [vector]{.style-parameter}, [output]{.style-parameter} |
| Parameter values | [occurrences]{.style-value} |
| Menu and toolbar items | [File → Import]{.style-menu} |
| Module output, messages | [duplicate points detected]{.style-output} |

:::

Throughout the text you'll find literature references and footnotes. You are encouraged to check them out. Simply hover over the link with your mouse. You'll also find that some code includes explanatory notes. You can read these notes by clicking on the number next to the code.

If you find some errors or have suggestions for improvements, you can create an so-called issue at GitHub. To do so, click on {{< fa brands github >}} [Report an issue]{.style-menu} in the upper right corner of the page (you'll need a GitHub account). You can also send me a message using the form (see the green button in the lower right corner of this page).

## Install the software

Before diving into this reader, make sure to install GRASS, Maxent, and Java. Below, you'll find a brief guide on where to download the software and how to install it. Later on, you'll also install a number of GRASS addons. These provide additional functionality not yet available in the core software package.

### GRASS software

Visit the GRASS website and navigate to the [download page](https://grass.osgeo.org/download/) for your operating system via the menu. Be sure to use the stable release (at the time of writing, this is version 8.4.2).

::: {.callout-tip appearance="simple" collapse="true"}
Note that if you already have QGIS installed on your Windows system, there’s a good chance you also have GRASS installed. In that case, simply check whether the latest version is installed.
:::

For Windows users, the [download page](https://grass.osgeo.org/download/windows/) offers two main options: the standalone winGRASS installer and the OSGeo4W installer. I recommend using the OSGeo4W installer, as it allows you to install a wide range of open-source geospatial software packages, including QGIS and GDAL/OGR. Additionally, it provides a more convenient way to keep your software up to date.


### GRASS addons {#sec-addons}

GRASS addons are modules that are not (yet) part of the core software package and therefore need to be installed separately. This can be done using the [wxGUI Extension Manager]{.style-menu} or using the command line. See @sec-usingaddons for details. In this tutorials, we'll use a number of addons, which we will install first.

::: {#exm-JWByktRMjx .hiddendiv}
:::

::: {.panel-tabset group="interface"}
## {{< fa solid terminal >}}

``` bash
# Maxent addons
g.extension extension=r.maxent.setup
g.extension extension=r.maxent.train
g.extension extension=r.maxent.predict
g.extension extension=v.maxent.swd

# Data import and processing
g.extension extension=v.in.gbif
g.extension extension=r.vif
g.extension extension=r.mess
g.extension extension=r.vect.stats
g.extension extension=v.db.pyupdate

# Stats and data visualization
g.extension extension=r.vect.stats
g.extension extension=r.boxplot
g.extension extension=v.scatterplot
```

## {{< fa brands python >}}

``` python
# Maxent addons
gs.run_command("g.extension", extension="r.maxent.setup")
gs.run_command("g.extension", extension="r.maxent.train")
gs.run_command("g.extension", extension="r.maxent.predict")
gs.run_command("g.extension", extension="v.maxent.swd")

# Data import and processing
gs.run_command("g.extension", extension="v.in.gbif")
gs.run_command("g.extension", extension="r.vif")
gs.run_command("g.extension", extension="r.mess")
gs.run_command("g.extension", extension="r.vect.stats")
gs.run_command("g.extension", extension="v.db.pyupdate")

# Stats and data visualization
gs.run_command("g.extension", extension="r.vect.stats")
gs.run_command("g.extension", extension="r.boxplot")
gs.run_command("g.extension", extension="v.scatterplot")
```

## {{< fa regular window-restore >}}

Follow the steps shown in the video below to install the r.maxent.train addon. Repeat the same procedure for the remaining addons. Once installed, the addons are immediately available for use; however, a restart of GRASS GIS may be required for them to appear in the toolbox.

{{< video "https://ecodiv.earth/share/sdm_in_grassgis/install_addons.mp4" >}}
:::

### Maxent {#sec-maxentsoftware}

Two of the addons we just installed (*r.maxent.train* and *r.maxent.predict*) use the *Maxent* software in the background. We therefore need to install this software.

Download the Maxent software (version 3.4.4) from the [Maxent website](https://biodiversityinformatics.amnh.org/open_source/maxent/) and extract the *Maxent.jar* file. 

Install it into the GRASS add-on directory using the `r.maxent.setup` module. This will allow the other add-ons to find and use it automatically.

::: {#exm-l4ovVBumNL .hiddendiv}
:::

::: {.panel-tabset group="interface"}
## {{< fa solid terminal >}}

Make sure you know where you have extracted the *Maxent.jar* file. You need to provide the full path below.

``` bash
r.maxent.setup maxent=path-to-file/maxent.jar
```

## {{< fa brands python >}}

Make sure you know where you have extracted the *Maxent.jar* file. You need to provide the full path to the file.

``` python
gs.run_command("r.maxent.setup", maxent="path-to-file/maxent.jar")
```

## {{< fa regular window-restore >}}

Open the `r.maxent.setup` module dialog and run it with the following parameter settings.

| Parameter | Value                   |
|-----------|-------------------------|
| maxent    | path-to-file/maxent.jar |

Note that you can also use the browse button in the `r.maxent.setup` module dialog to find the file.
:::

Note that you only have to do this once. If you already installed the *Maxent.jar* file, but want to update it, you can use the `-u` flag. This will replace the older version with the new one.

### Java JRE

The *Maxent* software requires *Java* or the *Java Runtime Environment* (JRE) version 1.4 or later to be installed on your computer. There is a good chance you already have Java installed. You can check this using the step below.

::: {#exm-forg895afd .hiddendiv}
:::

::: {.panel-tabset group="os"}
## {{< fa brands linux >}}

Open the command line, and type:

``` bash
java --version
```

## {{< fa brands windows >}}

In the Window search bar, type `cmd` and hit enter. This will open the Command prompt. Next, type in the following code string.

``` bash
java --version
```

## {{< fa brands apple >}}

I have no access to an Apple computer, but perhaps [this page](https://javaforge.com/how-to-find-java-path-in-mac/) can help you. Otherwise, you'll need to look it up yourself.

:::

If you have *Java* on your computer, it should show you the version. If not, you'll get the message that it cannot be found. In that case, download the Java Runtime Environment (JRE)  from e.g., the [azul.com download page](https://www.azul.com/downloads/#zulu) and install it.

![Download section of Java 25 JRE for various operating systems on the Azul download page.](images/downloadjavaJRE.png){#fig-azuldownloadpage width=650}

Now we need to ensure that *GRASS* can locate the *Java* executable. On Linux, and in some cases on Windows, GRASS may have access to Java without further steps. You can check this using the following command.

::: {#exm-eUGszZQwy4 .hiddendiv}
:::

::: {.panel-tabset group="interface"}
## {{< fa solid terminal >}}

``` bash
r.maxent.setup -j
```

## {{< fa brands python >}}

``` python
gs.run_command("r.maxent.setup", flags="j")
```

## {{< fa regular window-restore >}}

Open the `r.maxent.setup` module dialog and run it with the following parameter settings.

| Parameter                                    | Value |
|----------------------------------------------|-------|
| Check if Java can be found on the system (j) | ✅    |
:::

If you see the message that [Java is accessible from GRASS]{.style-output}, you can skip the rest of the steps on this page. If you get the warning that [Java cannot be found from GRASS]{.style-output}, you need to find the path to the java executable. See below for suggestions for how to find this.

::: {#exm-sa2Ci8G2Aj .hiddendiv}
:::

::: {.panel-tabset group="os"}
## {{< fa brands linux >}}

Open the command line, and type the following to get the path to the java executable:

``` bash
which java
```

## {{< fa brands windows >}}

On Windows, Java is usually installed in the directory [C:/Program Files/Java]{.style-menu}. You can check if this folder exists. If the folder does not exist, we can’t be sure that Java is not installed on your computer. It could have been installed in a different path.

To find out, in the Window search bar, type [cmd]{.style-menu} and hit enter. This will open the Command prompt. Next, type in the following code string.

``` bash
where java
```

If the code above doesn't work, you can try the code below (you can also try to replace `java.exe` with `javac.exe`).

``` bash
for %i in (java.exe) do @echo.   %~$PATH:i
```

Alternatively, you can search for the [java.exe]{.style-data} file on the disk. Open [My Computer]{.style-menu} where you can see [C drive]{.style-menu}, [D drive]{.style-menu} etc. On the top right corner you can see [Search bar]{.style-menu}. Enter `java.exe` and hit enter. Note, this may take some time.

## {{< fa brands apple >}}

Please search online for how to find the path to the Java executable.
:::

Make sure to write down the full path to the java executable. On Windows, this could for example be [C:/Program Files/Java/java.exe]{.style-menu}. Use this as input for [r.maxent.setup](https://grass.osgeo.org/grass-stable/manuals/addons/r.maxent.setup.html).

::: {#exm-WkMBbifIZR .hiddendiv}
:::

::: {.panel-tabset group="interface"}
## {{< fa solid terminal >}}

``` bash
r.maxent.setup java=path-to-java/java.exe
```

## {{< fa brands python >}}

``` python
gs.run_command("r.maxent.setup", java="path-to-java/java.exe")
```

## {{< fa regular window-restore >}}

Open the `r.maxent.setup` module dialog and run it with the following parameter settings.

| Parameter | Value                 |
|-----------|-----------------------|
| java      | path-to-java/java.exe |
:::

Note that @exm-l4ovVBumNL and @exm-WkMBbifIZR can be combined in one step by providing both the [maxent]{.style-parameter} and [java]{.style-parameter} parameters to `r.maxent.setup` at the same time.

<!-- Read the Formbutton docs at formspree.io/formbutton/docs. See more examples at codepen.io/formspree -->

```{=html}
<script src="https://formspree.io/js/formbutton-v1.min.js" defer></script>
```

```{=html}
<script>
  /* paste this line in verbatim */
  window.formbutton=window.formbutton||function(){(formbutton.q=formbutton.q||[]).push(arguments)};
  /* customize formbutton below*/     
  formbutton("create", {
    action: "https://formspree.io/f/xjvppyvg",
    title: "Feedback", 
    fields: [
      { 
        type: "email", 
        label: "Email:", 
        name: "email",
        required: true,
        placeholder: "your@email.com"
      },
      {
        type: "hidden",
        label: "",
        value: "sdmingrass - 1 Introduction",
      },
      {
        type: "textarea",
        label: "Message:",
        name: "message",
        placeholder: "Question or feedback? Send us a message.",
      },
      { type: "submit" }      
    ],
    styles: {
      title: {
        backgroundColor: "#57B444"
      },
      button: {
        backgroundColor: "#57B444"
      }
    }
  });
</script>
```
